# task_final_Rick_n_Morty
Финальный курсовой проект для Aston по м/ф "Рик и Морти"

Задача: Разработка Android приложения для работы с rickandmortyapi.com
Язык разработки: Котлин 
Архитектура: MVVM
Работа с многопоточностью: RxJava (возможно Корутины.)

Общие моменты:
Работа по каждому шагу разработки ведётся в отдельной ветке git-репозитория. На финальной стадии
ветки "мерджатся" и решаются конфликты слияний.

Шаги разработки:

- разработка UI 
- разрабока ViewModel
- разрабока Repository
- настройка Retrofit
- настройка RoomDataBase

UI:
- SplashScreen: При запуске приложения показывается SplashScreen (найти стороннюю библиотеку для этого)
- Навигация по приложению: Далее стартует приложение. Показывается единственное активити (вся навигация
планируется во фрагментах). Внизу фрагментов располагается BottomNavigationView с иконками для -  перехода 
на фрагменты с персонажами, с локациями, эпизодами сериала "Рик и Морти". Первый отображаемый фрагмент - 
вкладка с персонажами. Транзакция добавляется в backstack, поддерживается "навигация назад" через popBackStack.
- Для отображения списков используется RecyclerView. Для обновления данных используется DiffUtils.
- ViewHolder: Слева сположена TextView c названием и (для персонажей картинка), справа - всё остальное.
"Всё остальное" предполагаю отображать в единственном TextView через переопределённый toString() data class'а.
По нажатию на ViewHolder переход на фрагмент с деталями, отображенного элемента. 
- Picasso: Для загрузки изображений используется Picasso.
- Пагинация: Планирую использовать Jetpack Paging Library v3 для подгрузки данных "порциями". (Планирую "прикрутить" 
в самую последнюю очередь, после того как все остальное по UI будет готово).
- Поиск: Через SearchView в ActionBar.
- Фильтрация: Через DrawerLayout по критериям: имя (вводится в EditText), статус (выбирается в Spinner из 
вариантов alive, dead или unknown), тип (вводится в EditText), вид (вводится в EditText), пол (выбирается
в Spinner из вариантов female, male, genderless или unknownn).
- Pull-to-Refresh: Вкладки со списками поддерживают Pull-to-Refresh. (Проверяет наличие интернета, и, если 
интернет доступен, то через ViewModel получает данные из интернета.)
- ProgressBar: присутствует в каждом фрагменте, как со списком, так и с деталями; в обычном состоянии invisible, 
при загрузке данных - visible.
- Тестирование: Тестирование работы UI выполняется на "захардкоженных значениях".

ViewModel:
- Наследуется от ViewModel.
- Создается в момент создания фрагмента. Для каждого фрагмента отдельная ViewModel.
- Служит для сохранения данных во время пересоздания activity при изменении ориентации экрана. Основное наполнение 
Livedata'ы для связи Repository и UI.
- Напрямую взаимодействует с Repository.
- При уничтожении закрывает ViewModel вызывает dispose у выполняемых Rx-вызовов (цепочек методов).

  Пример ViewModel для фрагмента со списком:
  -- поле со ссылкой на репозиторий
  -- поле с Livedata для списка
  -- поле с Livedata для ProgressBar
  -- функция для Pull-to-Refresh, которая "дергает" репозиторий и пробует получить оттуда новые данные.
     
  Пример ViewModel для фрагмента с деталями:
  -- поле со ссылкой на репозиторий
  -- поле с Livedata для контента в виде data класса.
  -- поле с Livedata для ProgressBar
  -- функция для Pull-to-Refresh, которая "дергает" репозиторий и пробует получить оттуда новые данные.
  

Repository:
- Класс для непосредственного получения данных. Инкапсулирует всю логику для получения данных.
- проверяет наличие интернет-соединения: если интерет доступен, то работает с интернетом, иначе - с 
RoomDataBase.
- Кеширование: При загрузке данных из Интернет репозиторий проверяет наличие этих данных в Room, и если нет, 
то вносит данные в DB.
- Создается по принципу singleton.
- Предполагаемый список фунуций репозитория:
                                - получить все эпизоды
                                - получить всех персонажей
                                - получить все локации
                                - получить один определенный эпизод по id
                                - получить одного определённого персонажа по id
                                - получить одну опреденную локацию
                                - получить список эпизодов по фильтру
                                - получить список персонажей по фильтру
                                - получить список локаций по фильтру

Retrofit:
- используется для получения данных из интернета. 
- BASE_URL: https://rickandmortyapi.com/api/ .
- получаемый формат данных: json.
- GSON: для парсинга json в data классы используется бииблиотека GSON.
- используемые data классы: сharacter, location, episode. Классы планирую переиспользовать в RoomDataBase.

RoomDataBase:
- состоит из трёх таблиц: сharacters, locations, episodes.
- dao объекты: три dao, по одному на каждую таблицу.
- используемые data классы: сharacter, location, episode. Классы планирую переиспользовать в Retrofit.

Схема работы приложения:

Запуск:                 отображение SplashScreen ->
                        появляется MainActivity ->
                        создается стартовый фрагмент со списком персонажей ->
                        ProgressBar.visibility = Visibility.Visible (загрузка контента) ->
                        создается ViewModel ->
                        ViewMidel проверяет наличие интернет соединения ->
                        соединение недоступно:        данные поступают из RoomDataBase --->
                        соединение доступно:          Retrofit-запрос --->
                                                      получение json --->
                                                      парсинг с помощью gson --->
                        полученные данные помещаются в LiveData ->
                        отображение содержимого во фрагменте->
                        ProgressBar.visibility = Visibility.Invisible (загрузка контента закончена)
                                                     
